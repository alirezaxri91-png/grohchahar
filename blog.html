<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÙˆØ¨Ù„Ø§Ú¯Ú†Ù‡ Ø³Ø±ÛŒØ¹</title>
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;600&display=swap" rel="stylesheet">
<style>
body {
    font-family: 'Vazirmatn', sans-serif;
    margin:0;
    background:#0fbf8b;
    color:white;
    text-align:center;
}

h2 { margin-top:20px; font-size:28px; text-shadow:1px 1px 3px rgba(0,0,0,0.4);}
.container { max-width:700px; margin:auto; padding:15px; }

textarea, input {
    width:100%;
    padding:10px;
    margin-top:10px;
    border-radius:12px;
    border:none;
    outline:none;
    background:#006c54;
    color:white;
    font-size:16px;
    transition:0.3s;
}

textarea:focus, input:focus { background:#004d3d; }

button {
    margin-top:10px;
    padding:10px 20px;
    border:none;
    border-radius:12px;
    background:yellow;
    color:black;
    font-weight:bold;
    cursor:pointer;
    transition:0.3s;
}

button:hover { transform:scale(1.05); background:#ffd700; }

.post-box {
    background: rgba(0,77,61,0.9);
    padding:15px;
    border-radius:15px;
    margin-bottom:20px;
    text-align:right;
    box-shadow:0 4px 8px rgba(0,0,0,0.3);
}

.post-box img { width:100%; max-width:500px; border-radius:10px; margin-top:10px; }
a.download-link { color:yellow; text-decoration:none; font-weight:bold; margin-left:10px; }
a.download-link:hover { text-decoration:underline; }
</style>
</head>
<body>

<h2>ÙˆØ¨Ù„Ø§Ú¯Ú†Ù‡ Ø´Ø®ØµÛŒ Ø¹Ù„ÛŒØ±Ø¶Ø§</h2>
<p>Ø³Ù„Ø§Ù…https://dl2.soft98.ir/mobile/LDPlayer.4.0.83.x64.rar?1764396913 ğŸŒŸ</p>

<div class="container">
    <textarea id="postContent" placeholder="Ù…ØªÙ† Ù¾Ø³Øª..."></textarea>
    <input type="text" id="imageURL" placeholder="Ù„ÛŒÙ†Ú© Ø¹Ú©Ø³ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)">
    <input type="text" id="fileURL" placeholder="Ù„ÛŒÙ†Ú© ÙØ§ÛŒÙ„ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)">
    <button onclick="sendPost()">Ø§Ø±Ø³Ø§Ù„ Ù¾Ø³Øª</button>

    <hr style="margin:20px 0; border:1px solid #004d3d;">

    <div id="postsList"></div>
</div>

<script type="module">
import { createClient } from "https://esm.sh/@supabase/supabase-js";

const supabaseUrl = "https://xwibxxrqwcvilojadoig.supabase.co";
const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh3aWJ4eHJxd2N2aWxvamFkb2lnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzMTU3OTEsImV4cCI6MjA3OTg5MTc5MX0.FLzjzpvlVHHtfvxUYBzFlxzKoSK8Hu5vi-3HosG8Izw";

const supabase = createClient(supabaseUrl, supabaseKey);

// Ø§Ø±Ø³Ø§Ù„ Ù¾Ø³Øª
window.sendPost = async function() {
    const content = document.getElementById("postContent").value.trim();
    const imageURL = document.getElementById("imageURL").value.trim();
    const fileURL = document.getElementById("fileURL").value.trim();

    if(!content) { alert("Ù…ØªÙ† Ø®Ø§Ù„ÛŒÙ‡!"); return; }

    await supabase.from("posts").insert({
        author: "Ø¹Ù„ÛŒØ±Ø¶Ø§",
        content,
        image_url: imageURL || null,
        file_url: fileURL || null
    });

    document.getElementById("postContent").value="";
    document.getElementById("imageURL").value="";
    document.getElementById("fileURL").value="";

    loadPosts();
}

// Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù¾Ø³Øªâ€ŒÙ‡Ø§
async function loadPosts() {
    const { data: posts, error } = await supabase.from("posts").select("*").order("id",{ascending:false});
    if(error){ console.error(error); return; }

    let html="";
    posts.forEach(post=>{
        html += `<div class="post-box">
            <strong>${post.author}</strong><br><br>
            <p>${post.content}</p>
            ${post.image_url? `<img src="${post.image_url}">` : ""}
            ${post.file_url? `<a class="download-link" href="${post.file_url}" download>Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„</a>` : ""}
        </div>`;
    });
    document.getElementById("postsList").innerHTML=html;
}

// Ø¢Ù†Ù„Ø§ÛŒÙ† Ø´Ø¯Ù† Ù¾Ø³Øªâ€ŒÙ‡Ø§ Ø¨ÛŒÙ† Ù‡Ù…Ù‡
supabase
  .from('posts')
  .on('*', payload => loadPosts())
  .subscribe();

loadPosts();
</script>

</body>
</html>
